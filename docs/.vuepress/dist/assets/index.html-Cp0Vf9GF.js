import{_ as s,c as n,o as a,a as e}from"./app-DzsGjCpt.js";const t={},p=e(`<h1 id="backend-security" tabindex="-1"><a class="header-anchor" href="#backend-security"><span>Backend security</span></a></h1><p>The one thing that developers tend to considers at the end of the development cycle is the “security” of the application. A secure application is not a luxury, it’s a necessity. You should consider the security of your application at every phase of the development such as architecture, design, code, and finally the deployment.</p><blockquote><p>The basic principle of good security is <strong>never trust the user</strong>.</p></blockquote><p>From a backend perspective this also means not putting your trust in frontend validations of other security measures.</p><h2 id="data-validation" tabindex="-1"><a class="header-anchor" href="#data-validation"><span>Data Validation</span></a></h2><p>You must always validate or sanitize the data coming from the user or other entity of the system. The bad validation or no validation at all is a threat to the working system and can lead to a security exploit. You should also escape the output.</p><p>You can use a node module called <a href="https://www.npmjs.com/package/validator" target="_blank" rel="noopener noreferrer">validator</a> to perform the data validation. For example.</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token keyword">const</span> validator <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;validator&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">validator<span class="token punctuation">.</span><span class="token function">isEmail</span><span class="token punctuation">(</span><span class="token string">&#39;foo@bar.com&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//=&gt; true</span></span>
<span class="line">validator<span class="token punctuation">.</span><span class="token function">isEmail</span><span class="token punctuation">(</span><span class="token string">&#39;bar.com&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//=&gt; false</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>You can also use a module called <a href="https://www.npmjs.com/package/joi" target="_blank" rel="noopener noreferrer">joi</a> to perform the data/schema validation. For example.</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line">  <span class="token keyword">const</span> joi <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;joi&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token keyword">try</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">const</span> schema <span class="token operator">=</span> joi<span class="token punctuation">.</span><span class="token function">object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">      <span class="token literal-property property">name</span><span class="token operator">:</span> joi<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">required</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">email</span><span class="token operator">:</span> joi<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">email</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">required</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">password</span><span class="token operator">:</span> joi<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">required</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">const</span> dataToValidate <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;Ronny&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token literal-property property">email</span><span class="token operator">:</span> <span class="token string">&quot;ronny.com&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token literal-property property">password</span><span class="token operator">:</span> <span class="token string">&quot;123456&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">const</span> result <span class="token operator">=</span> schema<span class="token punctuation">.</span><span class="token function">validate</span><span class="token punctuation">(</span>dataToValidate<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token keyword">throw</span> result<span class="token punctuation">.</span>error<span class="token punctuation">.</span>details<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>message<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span>    </span>
<span class="line">  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>You should also escape the HTML or JSON output to users to prevent cross-site-scripting attacks. You can use <a href="https://github.com/component/escape-html" target="_blank" rel="noopener noreferrer">escape-html</a> libraries to perform output escaping.</p><p>You might be wondering though, how come a data input can lead to something disastrous? Well if your web application is not static and it involves some sort of database then a hacker can tweak the data input and take control of your database system. This is called “SQL Injection”. Let’s learn quickly what it is and how to prevent it from happening.</p><h2 id="sql-injection-attack" tabindex="-1"><a class="header-anchor" href="#sql-injection-attack"><span>SQL Injection Attack</span></a></h2><p>SQL injection is an exploit where malicious users can pass unexpected data and change the SQL queries. Let’s understand with the example.</p><p>Assume your SQL query looks like this:</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">UPDATE</span> users</span>
<span class="line">    <span class="token keyword">SET</span> first_name<span class="token operator">=</span><span class="token string">&quot;&#39; + req.body.first_name +  &#39;&quot;</span> <span class="token keyword">WHERE</span> id<span class="token operator">=</span><span class="token number">1332</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>In a normal scenario, you would expect that this query will look like this:</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">UPDATE</span> users</span>
<span class="line">    <span class="token keyword">SET</span> first_name <span class="token operator">=</span> <span class="token string">&quot;John&quot;</span> <span class="token keyword">WHERE</span> id <span class="token operator">=</span> <span class="token number">1332</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>Now, if someone passes the first_name as the value shown below:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">John&quot;, last_name=&quot;Wick&quot;; --</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Then, your SQL query will look like this:</p><div class="language-sql line-numbers-mode" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">UPDATE</span> users</span>
<span class="line">    <span class="token keyword">SET</span> first_name<span class="token operator">=</span><span class="token string">&quot;John&quot;</span><span class="token punctuation">,</span> last_name<span class="token operator">=</span><span class="token string">&quot;Wick&quot;</span><span class="token punctuation">;</span> <span class="token comment">--&quot; WHERE id=1001;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>If you observe, the WHERE condition is commented out and now the query will update the <strong>users</strong> table and sets every user’s first name as “John” and last name as “Wick”. This will eventually lead to system failure and if your database has no backup, then you’re doomed.</p><h3 id="how-to-prevent-sql-injection-attack" tabindex="-1"><a class="header-anchor" href="#how-to-prevent-sql-injection-attack"><span>How to prevent SQL Injection attack</span></a></h3><p>The most useful way to prevent SQL injection attacks is to sanitize input data. You can either validate every single input or validate using parameter binding. Parameter binding is mostly used by the developers as it offers efficiency and security. If you are using a popular ORM such as sequelize, hibernate, etc then they already provide the functions to validate and sanitize your data. If you are using database modules other than ORM such as mysql for Node, you can use the escaping methods provided by the module.</p><p>Let’s learn by example. The codebase shown below is using mysql module for Node.</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token keyword">var</span> mysql <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;mysql&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">var</span> connection <span class="token operator">=</span> mysql<span class="token punctuation">.</span><span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">host</span>     <span class="token operator">:</span> <span class="token string">&#39;localhost&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">user</span>     <span class="token operator">:</span> <span class="token string">&#39;me&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">password</span> <span class="token operator">:</span> <span class="token string">&#39;secret&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">database</span> <span class="token operator">:</span> <span class="token string">&#39;my_db&#39;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"> </span>
<span class="line">connection<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">connection<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span></span>
<span class="line">    <span class="token string">&#39;UPDATE users SET ?? = ? WHERE ?? = ?&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">[</span><span class="token string">&#39;first_name&#39;</span><span class="token punctuation">,</span>req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>first_name<span class="token punctuation">,</span> <span class="token punctuation">,</span><span class="token string">&#39;id&#39;</span><span class="token punctuation">,</span><span class="token number">1001</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">//...</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The double question mark is replaced with the field name and the single question mark is replaced with the value. This will make sure that input is safe. You can also use a stored procedure to increase the level of security but due to lack of maintainability developers tend to avoid using stored procedures.</p><p>You should also perform the server-side data validation.</p><h3 id="typecasting" tabindex="-1"><a class="header-anchor" href="#typecasting"><span>Typecasting</span></a></h3><p>JavaScript is a dynamic typed language i.e a value can be of any type. You can use the typecasting method to verify the type of data so that only the intended type of value should go into the database. For example, a user ID can only accept the number, there should be typecasting to ensure that the user ID should only be a number.</p><p>For example, let’s refer to the code we shown above.</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token keyword">var</span> mysql <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;mysql&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">var</span> connection <span class="token operator">=</span> mysql<span class="token punctuation">.</span><span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">host</span>     <span class="token operator">:</span> <span class="token string">&#39;localhost&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">user</span>     <span class="token operator">:</span> <span class="token string">&#39;me&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">password</span> <span class="token operator">:</span> <span class="token string">&#39;secret&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">database</span> <span class="token operator">:</span> <span class="token string">&#39;my_db&#39;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"> </span>
<span class="line">connection<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">connection<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span></span>
<span class="line">    <span class="token string">&#39;UPDATE users SET ?? = ? WHERE ?? = ?&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">[</span><span class="token string">&#39;first_name&#39;</span><span class="token punctuation">,</span>req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>first_name<span class="token punctuation">,</span> <span class="token punctuation">,</span><span class="token string">&#39;id&#39;</span><span class="token punctuation">,</span><span class="token function">Number</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token constant">ID</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">//...</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Did you notice the change?</p><p>We used <code>Number(req.body.ID)</code> to ensure that ID is always the number.</p><h2 id="application-authentication-and-authorization" tabindex="-1"><a class="header-anchor" href="#application-authentication-and-authorization"><span>Application Authentication and Authorization</span></a></h2><p>Sensitive data such as passwords should be stored in the system in a secure way that malicious users don’t misuse sensitive information. In this section, we will learn how to store and manage passwords which are quite generic, and pretty much every application has passwords in some way in their system.</p><h3 id="password-hashing" tabindex="-1"><a class="header-anchor" href="#password-hashing"><span>Password Hashing</span></a></h3><p>Hashing is a function that generates a fixed-size string from input. The output from the hashing function cannot be decrypted hence it’s “one-way” in nature. For data such as passwords, you must always use hashing algorithms to generate a hash version of the input password string which is a plaintext string.</p><p>You might be wondering that if the hash is a one-way string then how come attackers gain access to passwords?</p><p>Well, as I mentioned above, hashing takes an input string and generates a fixed-length output. So attackers take a reverse approach and they generate the hashes from the general password list, then they compare the hash with the hashes in your system to find the password. This attack is called <strong>lookup tables</strong> attack.</p><p>This is the reason why you as an architect of the system must not allow generic used passwords in your system. To overcome this attack, you can use something called <strong>“salt”</strong>. Salt is attached to the password hash to make it unique irrespective of the input. Salt has to be generated securely and randomly so that it is not predictable.</p><p>The Hashing algorithm we suggest you is <strong>BCrypt</strong>. At the time of writing this article, Bcrypt has not been exploited and considered cryptographically secure. In Node.js, you can use <strong>bcyrpt</strong> node module to perform the hashing.</p><p>Please refer to the example code below.</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token keyword">const</span> bcrypt <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;bcrypt&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">const</span> saltRounds <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">const</span> password <span class="token operator">=</span> <span class="token string">&quot;Some-Password@2023&quot;</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">bcrypt<span class="token punctuation">.</span><span class="token function">hash</span><span class="token punctuation">(</span></span>
<span class="line">    password<span class="token punctuation">,</span></span>
<span class="line">    saltRounds<span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> passwordHash</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">//we will just print it to the console for now</span></span>
<span class="line">    <span class="token comment">//you should store it somewhere and never logs or print it</span></span>
<span class="line">   </span>
<span class="line">    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Hashed Password:&quot;</span><span class="token punctuation">,</span> passwordHash<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The <strong>SaltRounds</strong> function is the cost of the hash function. The higher the cost, the more secure hash would be generated. You should decide the salt based on the computing power of your server.</p><p>Once the hash is generated for a password, the password entered by the user will be compared to the hash stored in the database. Refer to the code below for reference.</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token keyword">const</span> bcrypt <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;bcrypt&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">const</span> incomingPassword <span class="token operator">=</span> <span class="token string">&quot;Some-Password@2023&quot;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">const</span> existingHash <span class="token operator">=</span> <span class="token string">&quot;some-hash-previously-generated&quot;</span></span>
<span class="line"></span>
<span class="line">bcrypt<span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span></span>
<span class="line">    incomingPassword<span class="token punctuation">,</span></span>
<span class="line">    existingHash<span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">if</span><span class="token punctuation">(</span>res <span class="token operator">&amp;&amp;</span> res <span class="token operator">===</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Valid Password&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token comment">//invalid password handling here</span></span>
<span class="line">        <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Invalid Password&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="password-storage" tabindex="-1"><a class="header-anchor" href="#password-storage"><span>Password Storage</span></a></h3><p>Whether you use the database, files to store passwords, you must not store a plain text version. As we studied above, you should generate the hash and store the hash in the system. I generally recommend using <strong>varchar(255)</strong> data type in case of a password. You can opt for an unlimited length field as well.</p><p>If you are using bcrypt then you can use <strong>varchar(60)</strong> field because bcrypt will generate fixed size 60 character hashes.</p><h3 id="authorization" tabindex="-1"><a class="header-anchor" href="#authorization"><span>Authorization</span></a></h3><p>A system with proper user roles and permission prevents malicious users to act outside of their permission. To achieve a proper authorization process, proper roles and permissions are assigned to each user so that they can do certain tasks and nothing more. In Node.js, you can use a famous module called <strong>ACL</strong> to develop access control lists based authorization in your system.</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token keyword">const</span> <span class="token constant">ACL</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;acl2&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">const</span> acl <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ACL</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ACL<span class="token punctuation">.</span>memoryBackend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token comment">// guest is allowed to view blogs</span></span>
<span class="line">acl<span class="token punctuation">.</span><span class="token function">allow</span><span class="token punctuation">(</span><span class="token string">&#39;guest&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;blogs&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token comment">// check if the permission is granted</span></span>
<span class="line">acl<span class="token punctuation">.</span><span class="token function">isAllowed</span><span class="token punctuation">(</span><span class="token string">&#39;Lisa&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;blogs&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;view&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;User Lisa is allowed to view blogs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Checkout the acl2 documentation for more information and example code.</p><h2 id="bruteforce-attack-prevention" tabindex="-1"><a class="header-anchor" href="#bruteforce-attack-prevention"><span>Bruteforce Attack Prevention</span></a></h2><p>Bruteforce is an attack where a hacker uses software to try different passwords repetitively until access is granted i.e valid password is found. To prevent a Bruteforce attack, one of the simplest ways is to <strong>wait it out</strong> approach. When someone is trying to login into your system and tried an invalid password more than 3 times, make them wait for 60 seconds or so before trying again. This way the attacker is going to be slow and it’s gonna take them forever to crack a password.</p><p>Another approach to preventing it is to ban the IP that is generating invalid login requests. Your system allows 3 wrong attempts per IP in 24 hours. If someone tries to do brute-forcing then block the IP for 24 hours. This rate-limiting approach is been used by lots of companies to prevent brute-force attacks.</p><p>If you are using the Express framework, there is a middleware module to enable rate-limiting in incoming requests. Its called <strong>express=brute</strong>. You can check the example code below.</p><p>Install the dependency.</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">npm</span> <span class="token function">install</span> express-brute <span class="token parameter variable">--save</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Enable it in your route.</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token keyword">const</span> ExpressBrute <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;express-brute&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExpressBrute<span class="token punctuation">.</span>MemoryStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// stores state locally, don&#39;t use this in production</span></span>
<span class="line"><span class="token keyword">const</span> bruteforce <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExpressBrute</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"> </span>
<span class="line">app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&#39;/auth&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    bruteforce<span class="token punctuation">.</span>prevent<span class="token punctuation">,</span> <span class="token comment">// error 429 if we hit this route too often</span></span>
<span class="line">    <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&#39;Success!&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token comment">//...</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The example code is taken from <a href="https://www.npmjs.com/package/express-brute" target="_blank" rel="noopener noreferrer">express-brute</a> module documentation.</p><h2 id="secure-transmission-using-https" tabindex="-1"><a class="header-anchor" href="#secure-transmission-using-https"><span>Secure Transmission using HTTPS</span></a></h2><p>You must use HTTPS to send your data and traffic over the internet securely. HTTPS is an extension of the HTTP protocol with secure communication support. By using HTTPS, you can make sure that the traffic and your user’s data over the internet is encrypted and safe.</p><p>I am not going to explain how HTTPS works in the detail here. We are going to focus on the implementation part of it. I highly recommend you to use <strong>LetsEncrypt</strong> to generate the SSL certificates for all of your domain/subdomain. It’s free and runs a daemon to update SSL certificates every 90 days.</p><p>You can learn more about LetsEncrypt <a href="https://letsencrypt.org/getting-started/" target="_blank" rel="noopener noreferrer">here</a>.</p><p>You can opt for a domain-specific certificate or a wildcard certificate if you have multiple subdomains. LetsEncrypt supports both.</p><p>You can use LetsEncrypt for both Apache and Nginx based web servers. I highly recommend performing SSL negotiations in the reverse proxy or at the gateway layer because it is a heavy computing operation.</p><h2 id="session-hijacking-prevention" tabindex="-1"><a class="header-anchor" href="#session-hijacking-prevention"><span>Session Hijacking Prevention</span></a></h2><p>The session is an important part of any dynamic web application. Having a secure session in the application is a must for the users and systems safety. A session is implemented using cookies and it must be kept secure to prevent session hijacking.</p><p>The following is a list of the attributes that can be set for each cookie and what they mean:</p><ul><li><strong>secure</strong> – this attribute tells the browser to only send the cookie if the request is being sent over HTTPS.</li><li><strong>HttpOnly</strong> – this attribute is used to help prevent attacks such as cross-site scripting since it does not allow the cookie to be accessed via JavaScript.</li><li><strong>domain</strong> – this attribute is used to compare against the domain of the server in which the URL is being requested. If the domain matches or if it is a sub-domain, then the path attribute will be checked next. path – in addition to the domain, the URL path that the cookie is valid for can be specified. If the domain and path match, then the cookie will be sent in the request.</li><li><strong>expires</strong> – this attribute is used to set persistent cookies since the cookie does not expire until the set date is exceeded</li></ul><p>You can use <strong>express-session</strong> npm module to perform session management in the Express framework.</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;express&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">const</span> session <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;express-session&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">secret</span><span class="token operator">:</span> <span class="token string">&#39;keyboard cat&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">resave</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">saveUninitialized</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">cookie</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">secure</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">&#39;/&#39;</span><span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="cross-site-request-forgery-csrf-attack-prevention" tabindex="-1"><a class="header-anchor" href="#cross-site-request-forgery-csrf-attack-prevention"><span>Cross Site Request Forgery (CSRF) Attack Prevention</span></a></h2><p>CSRF is an attack where that manipulates a trusted user of a system to execute unwanted malicious actions on a web application. In Node.js, we can use <strong>csurf</strong> module to mitigate CSRF attack. This module requires either <strong>express-session</strong> or <strong>cookie-parser</strong> to be initialized first. You can check out the example code below.</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;express&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">const</span> cookieParser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;cookie-parser&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">const</span> csrf <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;csurf&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">const</span> bodyParser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;body-parser&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"> </span>
<span class="line"><span class="token comment">// setup route middlewares</span></span>
<span class="line"><span class="token keyword">const</span> csrfProtection <span class="token operator">=</span> <span class="token function">csrf</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">cookie</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">const</span> parseForm <span class="token operator">=</span> bodyParser<span class="token punctuation">.</span><span class="token function">urlencoded</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">extended</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"> </span>
<span class="line"><span class="token comment">// create express app</span></span>
<span class="line"><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"> </span>
<span class="line"><span class="token comment">// we need this because &quot;cookie&quot; is true in csrfProtection</span></span>
<span class="line">app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">cookieParser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"> </span>
<span class="line">app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/form&#39;</span><span class="token punctuation">,</span> csrfProtection<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// pass the csrfToken to the view</span></span>
<span class="line">  res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">&#39;send&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">csrfToken</span><span class="token operator">:</span> req<span class="token punctuation">.</span><span class="token function">csrfToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"> </span>
<span class="line">app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&#39;/process&#39;</span><span class="token punctuation">,</span> parseForm<span class="token punctuation">,</span> csrfProtection<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&#39;data is being processed&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>On the web page, you need to create a hidden input type with the value of the CSRF token. For example.</p><div class="language-html line-numbers-mode" data-highlighter="prismjs" data-ext="html" data-title="html"><pre><code><span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/process<span class="token punctuation">&quot;</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>POST<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hidden<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>_csrf<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{csrfToken}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span></span>
<span class="line"> </span>
<span class="line">  Favorite color: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>favoriteColor<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Submit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>In the case of AJAX requests, you can pass the CSRF token in the header.</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line">  <span class="token keyword">var</span> token <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;meta[name=&quot;csrf-token&quot;]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&#39;content&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token string-property property">&#39;CSRF-Token&#39;</span><span class="token operator">:</span> token</span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="denial-of-service" tabindex="-1"><a class="header-anchor" href="#denial-of-service"><span>Denial of Service</span></a></h2><p>Denial of service or DOS is a type of attack where attackers tried to bring down the service or make it inaccessible to users by disrupting the system. The attacker generally flooded the systems with lots of traffic or requests which in turn increases the CPU and memory load leading to a system crash.</p><p>To mitigate DOS attacks in your Node.js application, the first step would be the identification of such an event. I highly recommend these two modules to be integrated into the system.</p><ol><li>Account lockout – After n number of failed attempts, lock the account or IP address for a period of time (say 24h?)</li><li>Rate limiting – Limit the users to request the system n number of times within a specific period, for example, 3 requests per minute from an individual user</li></ol><p>The Regular expression Denial of service attack (ReDOS)is a type of DOS attack where the attacker exploits the regular expression implementation in the system. Some regular expression takes heavy computing power to execute and the attacker can exploit it by submitting requests that involve regular expression in the system which in turns increases the load on the system leading to system failure.</p><p>You can use software like <a href="https://github.com/davisjam/vuln-regex-detector" target="_blank" rel="noopener noreferrer">this</a> to detect dangerous regular expression and avoid to use them in your system.</p><h2 id="dependencies-validation" tabindex="-1"><a class="header-anchor" href="#dependencies-validation"><span>Dependencies Validation</span></a></h2><p>We all use tons of dependencies in our projects. We need to check and validate these dependencies as well to ensure the security of the overall project. NPM already has an audit feature to find the vulnerability of the project. Just run the command shown below in your source code directory.</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">npm</span> audit</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>To fix the vulnerability, you can run this command.</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">npm</span> audit fix</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>You can also run the dry run to check the fix before applying it to your project.</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">npm</span> audit fix --dry-run <span class="token parameter variable">--json</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="http-security-headers" tabindex="-1"><a class="header-anchor" href="#http-security-headers"><span>HTTP Security Headers</span></a></h2><p>HTTP provides several security headers that can prevent commonly known attacks. If you are using the Express framework then you can use a module called <a href="https://helmetjs.github.io/" target="_blank" rel="noopener noreferrer">helmet</a> to enable all security headers with a single line of code.</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">npm</span> <span class="token function">install</span> helmet <span class="token parameter variable">--save</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Here is how to use it.</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;express&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">const</span> helmet <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;helmet&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">helmet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">//...</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>This enables the following HTTP headers:</p><ul><li>Strict-Transport-Security</li><li>X-frame-Options</li><li>X-XSS-Protection</li><li>X-Content-Type-Protection</li><li>Content-Security-Policy</li><li>Cache-Control</li><li>Expect-CT</li><li>Disable X-Powered-By</li></ul><p>These headers prevent malicious users from various types of attacks such as clickjacking, cross-site scripting, etc.</p>`,104),o=[p];function i(c,l){return a(),n("div",null,o)}const u=s(t,[["render",i],["__file","index.html.vue"]]),d=JSON.parse('{"path":"/54_security/","title":"Backend security","lang":"en-US","frontmatter":{},"headers":[{"level":2,"title":"Data Validation","slug":"data-validation","link":"#data-validation","children":[]},{"level":2,"title":"SQL Injection Attack","slug":"sql-injection-attack","link":"#sql-injection-attack","children":[{"level":3,"title":"How to prevent SQL Injection attack","slug":"how-to-prevent-sql-injection-attack","link":"#how-to-prevent-sql-injection-attack","children":[]},{"level":3,"title":"Typecasting","slug":"typecasting","link":"#typecasting","children":[]}]},{"level":2,"title":"Application Authentication and Authorization","slug":"application-authentication-and-authorization","link":"#application-authentication-and-authorization","children":[{"level":3,"title":"Password Hashing","slug":"password-hashing","link":"#password-hashing","children":[]},{"level":3,"title":"Password Storage","slug":"password-storage","link":"#password-storage","children":[]},{"level":3,"title":"Authorization","slug":"authorization","link":"#authorization","children":[]}]},{"level":2,"title":"Bruteforce Attack Prevention","slug":"bruteforce-attack-prevention","link":"#bruteforce-attack-prevention","children":[]},{"level":2,"title":"Secure Transmission using HTTPS","slug":"secure-transmission-using-https","link":"#secure-transmission-using-https","children":[]},{"level":2,"title":"Session Hijacking Prevention","slug":"session-hijacking-prevention","link":"#session-hijacking-prevention","children":[]},{"level":2,"title":"Cross Site Request Forgery (CSRF) Attack Prevention","slug":"cross-site-request-forgery-csrf-attack-prevention","link":"#cross-site-request-forgery-csrf-attack-prevention","children":[]},{"level":2,"title":"Denial of Service","slug":"denial-of-service","link":"#denial-of-service","children":[]},{"level":2,"title":"Dependencies Validation","slug":"dependencies-validation","link":"#dependencies-validation","children":[]},{"level":2,"title":"HTTP Security Headers","slug":"http-security-headers","link":"#http-security-headers","children":[]}],"git":{"updatedTime":1687801228000,"contributors":[{"name":"Ronny Mees","email":"ronny.mees@vives.be","commits":1}]},"filePathRelative":"54_security/README.md"}');export{u as comp,d as data};
